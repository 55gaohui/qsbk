{"version":3,"sources":["webpack:////Users/gaohui/study/qsbk/main.js","webpack:////Users/gaohui/study/qsbk/pages/user-feedback/user-feedback.vue?0efa","webpack:////Users/gaohui/study/qsbk/pages/user-feedback/user-feedback.vue?def5","webpack:////Users/gaohui/study/qsbk/pages/user-feedback/user-feedback.vue?2ad9","webpack:////Users/gaohui/study/qsbk/pages/user-feedback/user-feedback.vue?98d3","webpack:////Users/gaohui/study/qsbk/pages/user-feedback/user-feedback.vue"],"names":["createPage","Page","name","components","userChatBottom","userChatList","data","scrollTop","style","contentH","itemH","list","page","loadtext","onReady","getdata","initdata","methods","res","uni","getSystemInfoSync","windowHeight","upx2px","e","loadmore","pageToBottom","isfirst","q","createSelectorQuery","in","selectAll","$nextTick","fields","size","i","length","height","exec","$http","get","token","checkToken","err","errorCheck","arr","from_id","User","userinfo","id","to_id","isme","push","userpic","type","time","create_time","gstime","gettime","getChatTime","submit","post","now","Date","getTime","showToast","title"],"mappings":"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","file":"pages/user-feedback/user-feedback.js","sourcesContent":["import 'uni-pages';import '@dcloudio/uni-stat';\n\nimport Vue from 'vue'            \nimport Page from './pages/user-feedback/user-feedback.vue'\ncreatePage(Page)","import { render, staticRenderFns } from \"./user-feedback.vue?vue&type=template&id=dd503c4e&\"\nimport script from \"./user-feedback.vue?vue&type=script&lang=js&\"\nexport * from \"./user-feedback.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('dd503c4e', component.options)\n    } else {\n      api.reload('dd503c4e', component.options)\n    }\n    module.hot.accept(\"./user-feedback.vue?vue&type=template&id=dd503c4e&\", function () {\n      api.rerender('dd503c4e', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"Users/gaohui/study/qsbk/pages/user-feedback/user-feedback.vue\"\nexport default component.exports","export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-hbuilderx/packages/webpack-uni-nvue-loader/lib/templateLoader.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./user-feedback.vue?vue&type=template&id=dd503c4e&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./user-feedback.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./user-feedback.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport time from \"../../common/time.js\"\nimport userChatList from \"../../components/user-chat/user-chat-list.vue\"\nimport userChatBottom from \"../../components/user-chat/user-chat-bottom.vue\"\nexport default {\n\tname: \"user-feedback\",\n\tcomponents: {\n\t\tuserChatBottom,\n\t\tuserChatList\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tscrollTop: 0,\n\t\t\tstyle: {\n\t\t\t\tcontentH: 0,\n\t\t\t\titemH: 0\n\t\t\t},\n\t\t\tlist: [],\n\t\t\tpage:1,\n\t\t\tloadtext:\"点击加载更多\"\n\t\t};\n\t},\n\tonReady() {\n\t\tthis.getdata();\n\t\tthis.initdata();\n\t},\n\tmethods: {\n\t\t// 初始化参数\n\t\tinitdata() {\n\t\t\ttry {\n\t\t\t\tconst res = uni.getSystemInfoSync();\n\t\t\t\tthis.style.contentH = res.windowHeight - uni.upx2px(140);\n\t\t\t} catch (e) {}\n\t\t},\n\t\t// 加载更多\n\t\tloadmore(){\n\t\t\tif(this.loadtext!=\"点击加载更多\") return;\n\t\t\t// 修改状态\n\t\t\tthis.loadtext=\"加载中...\";\n\t\t\tthis.page++;\n\t\t\tthis.getdata();\n\t\t},\n\t\tpageToBottom(isfirst = false) {\n\t\t\tlet q = uni.createSelectorQuery().in(this);\n\t\t\tlet itemH =q.selectAll('.char-item');\n\t\t\tthis.$nextTick(() => {\n\t\t\t\titemH.fields({\n\t\t\t\t\tsize: true\n\t\t\t\t}, data => {\n\t\t\t\t\tif (data) {\n\t\t\t\t\t\tif(isfirst){\n\t\t\t\t\t\t\tfor (let i = 0; i < data.length; i++) {\n\t\t\t\t\t\t\t\tthis.style.itemH += data[i].height;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tthis.style.itemH += data[data.length-1].height;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.scrollTop = (this.style.itemH > this.style.contentH) ? this.style.itemH : 0;\n\t\t\t\t\t}\n\t\t\t\t}).exec()\n\t\t\t})\n\t\t},\n\t\t// 获取聊天数据\n\t\tasync getdata() {\n\t\t\t// 从服务器获取到的数据\n\t\t\tlet [err,res] = await this.$http.get(`/feedbacklist/${this.page}`,{},{token:true,checkToken:true});\n\t\t\t// 错误处理\n\t\t\tif(!this.$http.errorCheck(err,res)) return;\n\t\t\t//成功\n\t\t\tlet list = res.data.data.list;\n\t\t\tlet arr = [];\n\t\t\tfor (let i = 0; i < list.length; i++) {\n\t\t\t\tif(list[i].from_id == this.User.userinfo.id || list[i].to_id == this.User.userinfo.id){\n\t\t\t\t\tlet isme = list[i].from_id == this.User.userinfo.id;\n\t\t\t\t\tarr.push({\n\t\t\t\t\t\tisme: isme,\n\t\t\t\t\t\tuserpic: isme ? this.User.userinfo.userpic :\"../../static/demo/userpic/11.jpg\",\n\t\t\t\t\t\ttype: \"text\",\n\t\t\t\t\t\tdata: list[i].data,\n\t\t\t\t\t\ttime: list[i].create_time,\n\t\t\t\t\t\tgstime: time.gettime.getChatTime(list[i].create_time,i>0 ? list[i-1].create_time:0)\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.loadtext = list.length < 10 ? \"没有更多数据啦\" : \"点击加载更多\";\n\t\t\t// arr.reverse();\n\t\t\tthis.list = [...arr,...this.list];\n\t\t\tif(this.page === 1 && this.list.length>0){\n\t\t\t\tthis.pageToBottom(true);\n\t\t\t}\n\t\t},\n\t\tasync submit(data) {\n\t\t\t// 构建数据\n\t\t\tlet [err,res] = await this.$http.post('/feedback',{data:data},{token:true,checkToken:true});\n\t\t\t//错误处理\n\t\t\tif(!this.$http.errorCheck(err,res)) return;\n\t\t\t//成功\n\t\t\t//构建数据\n\t\t\tlet now = new Date().getTime();\n\t\t\tlet gstime = time.gettime.getChatTime(now, this.list[this.list.length - 1].time);\n\t\t\tthis.list.push({\n\t\t\t\tisme: true,\n\t\t\t\tuserpic: this.User.userinfo.userpic,\n\t\t\t\ttype: \"text\",\n\t\t\t\tdata: data,\n\t\t\t\ttime: now,\n\t\t\t\tgstime: gstime\n\t\t\t});\n\t\t\tthis.pageToBottom();\n\t\t\tuni.showToast({title: \"反馈成功\"});\n\t\t}\n\t}\n}\n"],"sourceRoot":""}